<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDF Generator</title>
</head>
<body>
  <h1>PDF is downloaded</h1>
  <table id="my-table1"></table>
  <table id="my-table2"></table>
  <input id="input" type="file" accept="text/plain">
</body>
  

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.6/jspdf.plugin.autotable.min.js"></script>
 <script>

    const input = document.querySelector("#input");

    const dbcheckpoints = []
    const outputcheckpoints = []
    let all_headings = []
    let last = -1;

    input.addEventListener("change", () => {
      const file = input.files.item(0);
      fileToText(file, (text) => {
        const content = save(text, "fileName.txt", "text/plain")
        // ***********main logic starts***********
        const my_json = JSON.parse(content)
        last = my_json.pop()
        let summaryheadings =  Object.keys(last)
        let summary = Object.values(last)
        all_headings = Object.keys(my_json[0])
        const dbcount = 5
        const outputcount = 1
        let onedbpoint = []
        let oneoutputpoint = []
        my_json.forEach(element => {
          count = 0
          onedbpoint = []
          oneoutputpoint = []
          for (const [key, value] of Object.entries(element)) {
            if(count < dbcount){
              onedbpoint.push(value)
            }
            else{
              oneoutputpoint.push(value)
            }
            count += 1
          }
          dbcheckpoints.push(onedbpoint)
          outputcheckpoints.push(oneoutputpoint)
        });
        const dbheadings = all_headings.slice(0, dbcount)
        const outputheadings = all_headings.slice(dbcount, dbcount + outputcount)
        
        const doc = new jsPDF()

        doc.autoTable({ html: '#my-table1' })

        doc.autoTable({
          theme: 'grid',
          head: [summaryheadings],
          body: [summary],
        })

        doc.autoTable({
          theme: 'grid',
          head: [dbheadings],
          body: dbcheckpoints,
        })

        doc.autoTable({
          theme: 'grid',
          head: [outputheadings],
          body: outputcheckpoints,
        })

        doc.save('table.pdf')

      });
    });
    
    // not usefull logic
    function fileToText(file, callback) {
      const reader = new FileReader();
      const content = reader.readAsText(file);
      reader.onload = () => {
        callback(reader.result);
      };
      return content
    }

    function save(content, fileName, mime) {
      const blob = new Blob([content], {
        tipe: mime
      });
      return content
    }

  </script>
</html>